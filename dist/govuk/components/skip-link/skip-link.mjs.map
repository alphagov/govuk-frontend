{"version":3,"file":"skip-link.mjs","sources":["../../../../src/govuk/components/skip-link/skip-link.mjs"],"sourcesContent":["import { getFragmentFromUrl, setFocus } from '../../common/index.mjs'\nimport { ElementError } from '../../errors/index.mjs'\nimport { GOVUKFrontendComponent } from '../../govuk-frontend-component.mjs'\n\n/**\n * Skip link component\n *\n * @preserve\n */\nexport class SkipLink extends GOVUKFrontendComponent {\n  /** @private */\n  $module\n\n  /**\n   * @param {Element | null} $module - HTML element to use for skip link\n   * @throws {ElementError} when $module is not set or the wrong type\n   * @throws {ElementError} when $module.hash does not contain a hash\n   * @throws {ElementError} when the linked element is missing or the wrong type\n   */\n  constructor($module) {\n    super()\n\n    if (!($module instanceof HTMLAnchorElement)) {\n      throw new ElementError({\n        componentName: 'Skip link',\n        element: $module,\n        expectedType: 'HTMLAnchorElement',\n        identifier: 'Root element (`$module`)'\n      })\n    }\n\n    this.$module = $module\n\n    const hash = this.$module.hash\n    const href = this.$module.getAttribute('href') ?? ''\n\n    /** @type {URL | undefined} */\n    let url\n\n    /**\n     * Check for valid link URL\n     *\n     * {@link https://caniuse.com/url}\n     * {@link https://url.spec.whatwg.org}\n     *\n     */\n    try {\n      url = new window.URL(this.$module.href)\n    } catch (error) {\n      throw new ElementError(\n        `Skip link: Target link (\\`href=\"${href}\"\\`) is invalid`\n      )\n    }\n\n    // Return early for external URLs or links to other pages\n    if (\n      url.origin !== window.location.origin ||\n      url.pathname !== window.location.pathname\n    ) {\n      return\n    }\n\n    const linkedElementId = getFragmentFromUrl(hash)\n\n    // Check link path matching current page\n    if (!linkedElementId) {\n      throw new ElementError(\n        `Skip link: Target link (\\`href=\"${href}\"\\`) has no hash fragment`\n      )\n    }\n\n    const $linkedElement = document.getElementById(linkedElementId)\n\n    // Check for link target element\n    if (!$linkedElement) {\n      throw new ElementError({\n        componentName: 'Skip link',\n        element: $linkedElement,\n        identifier: `Target content (\\`id=\"${linkedElementId}\"\\`)`\n      })\n    }\n\n    /**\n     * Focus the linked element on click\n     *\n     * Adds a helper CSS class to hide native focus styles,\n     * but removes it on blur to restore native focus styles\n     */\n    this.$module.addEventListener('click', () =>\n      setFocus($linkedElement, {\n        onBeforeFocus() {\n          $linkedElement.classList.add('govuk-skip-link-focused-element')\n        },\n        onBlur() {\n          $linkedElement.classList.remove('govuk-skip-link-focused-element')\n        }\n      })\n    )\n  }\n\n  /**\n   * Name for the component used when initialising using data-module attributes.\n   */\n  static moduleName = 'govuk-skip-link'\n}\n"],"names":["SkipLink","GOVUKFrontendComponent","constructor","$module","_this$$module$getAttr","HTMLAnchorElement","ElementError","componentName","element","expectedType","identifier","hash","href","getAttribute","url","window","URL","error","origin","location","pathname","linkedElementId","getFragmentFromUrl","$linkedElement","document","getElementById","addEventListener","setFocus","onBeforeFocus","classList","add","onBlur","remove","moduleName"],"mappings":";;;;AAIA;AACA;AACA;AACA;AACA;AACO,MAAMA,QAAQ,SAASC,sBAAsB,CAAC;AAInD;AACF;AACA;AACA;AACA;AACA;EACEC,WAAWA,CAACC,OAAO,EAAE;AAAA,IAAA,IAAAC,qBAAA,CAAA;AACnB,IAAA,KAAK,EAAE,CAAA;AAAA,IAAA,IAAA,CATTD,OAAO,GAAA,KAAA,CAAA,CAAA;AAWL,IAAA,IAAI,EAAEA,OAAO,YAAYE,iBAAiB,CAAC,EAAE;MAC3C,MAAM,IAAIC,YAAY,CAAC;AACrBC,QAAAA,aAAa,EAAE,WAAW;AAC1BC,QAAAA,OAAO,EAAEL,OAAO;AAChBM,QAAAA,YAAY,EAAE,mBAAmB;AACjCC,QAAAA,UAAU,EAAE,0BAAA;AACd,OAAC,CAAC,CAAA;AACJ,KAAA;IAEA,IAAI,CAACP,OAAO,GAAGA,OAAO,CAAA;AAEtB,IAAA,MAAMQ,IAAI,GAAG,IAAI,CAACR,OAAO,CAACQ,IAAI,CAAA;AAC9B,IAAA,MAAMC,IAAI,GAAA,CAAAR,qBAAA,GAAG,IAAI,CAACD,OAAO,CAACU,YAAY,CAAC,MAAM,CAAC,KAAAT,IAAAA,GAAAA,qBAAA,GAAI,EAAE,CAAA;AAGpD,IAAA,IAAIU,GAAG,CAAA;IASP,IAAI;MACFA,GAAG,GAAG,IAAIC,MAAM,CAACC,GAAG,CAAC,IAAI,CAACb,OAAO,CAACS,IAAI,CAAC,CAAA;KACxC,CAAC,OAAOK,KAAK,EAAE;AACd,MAAA,MAAM,IAAIX,YAAY,CACpB,CAAmCM,gCAAAA,EAAAA,IAAI,iBACzC,CAAC,CAAA;AACH,KAAA;AAGA,IAAA,IACEE,GAAG,CAACI,MAAM,KAAKH,MAAM,CAACI,QAAQ,CAACD,MAAM,IACrCJ,GAAG,CAACM,QAAQ,KAAKL,MAAM,CAACI,QAAQ,CAACC,QAAQ,EACzC;AACA,MAAA,OAAA;AACF,KAAA;AAEA,IAAA,MAAMC,eAAe,GAAGC,kBAAkB,CAACX,IAAI,CAAC,CAAA;IAGhD,IAAI,CAACU,eAAe,EAAE;AACpB,MAAA,MAAM,IAAIf,YAAY,CACpB,CAAmCM,gCAAAA,EAAAA,IAAI,2BACzC,CAAC,CAAA;AACH,KAAA;AAEA,IAAA,MAAMW,cAAc,GAAGC,QAAQ,CAACC,cAAc,CAACJ,eAAe,CAAC,CAAA;IAG/D,IAAI,CAACE,cAAc,EAAE;MACnB,MAAM,IAAIjB,YAAY,CAAC;AACrBC,QAAAA,aAAa,EAAE,WAAW;AAC1BC,QAAAA,OAAO,EAAEe,cAAc;QACvBb,UAAU,EAAE,yBAAyBW,eAAe,CAAA,IAAA,CAAA;AACtD,OAAC,CAAC,CAAA;AACJ,KAAA;IAQA,IAAI,CAAClB,OAAO,CAACuB,gBAAgB,CAAC,OAAO,EAAE,MACrCC,QAAQ,CAACJ,cAAc,EAAE;AACvBK,MAAAA,aAAaA,GAAG;AACdL,QAAAA,cAAc,CAACM,SAAS,CAACC,GAAG,CAAC,iCAAiC,CAAC,CAAA;OAChE;AACDC,MAAAA,MAAMA,GAAG;AACPR,QAAAA,cAAc,CAACM,SAAS,CAACG,MAAM,CAAC,iCAAiC,CAAC,CAAA;AACpE,OAAA;AACF,KAAC,CACH,CAAC,CAAA;AACH,GAAA;AAMF,CAAA;AA/FahC,QAAQ,CA8FZiC,UAAU,GAAG,iBAAiB;;;;"}