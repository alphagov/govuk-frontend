{% from "../../macros/attributes.njk" import govukAttributes %}

{%- set menuButtonText = params.menuButtonText | default("Menu", true) -%}
{%- set navigationId = params.navigationId | default("navigation", true) %}

{% if params.serviceName or params.navigation | length %}
  <section class="govuk-service-header {%- if params.classes %} {{ params.classes }}{% endif %}" data-module="govuk-service-header" aria-label="Service information"
  {{- govukAttributes(params.attributes) }}>
    <div class="govuk-width-container">

        {# Slot: start #}
        {%- if params.slots.start %}{{ params.slots.start | safe }}{% endif -%}

        <div class="govuk-service-header__container">
          {# Service name #}
          {% if params.serviceName %}
            <span class="govuk-service-header__service-name">
              {% if params.serviceUrl %}
              <a href="{{ params.serviceUrl }}" class="govuk-service-header__link govuk-service-header__link--service-name">
                {{ params.serviceName }}
              </a>
              {% else %}
                {{- params.serviceName -}}
              {% endif %}
            </span>
          {% endif %}

          {# Navigation #}
          {% if params.navigation | length %}
            <nav aria-label="{{ params.navigationLabel | default(menuButtonText, true) }}" class="govuk-service-header__navigation {%- if params.navigationClasses %} {{ params.navigationClasses }}{% endif %}">
              <button type="button" class="govuk-service-header__toggle govuk-js-service-header-toggle" aria-controls="{{ navigationId }}" {%- if params.menuButtonLabel and params.menuButtonLabel != menuButtonText %} aria-label="{{ params.menuButtonLabel }}"{% endif %} hidden>
                {{ menuButtonText }}
              </button>

              <ul class="govuk-service-header__navigation-list" id="{{ navigationId }}" >

                {# Slot: navigationStart #}
                {%- if params.slots.navigationStart %}{{ params.slots.navigationStart | safe }}{% endif -%}

                {% for item in params.navigation %}
                  {% set linkInnerContent %}
                    {# We wrap active links in strong tags so that users who override colours or
                    styles will still have some indicator of the current nav item. #}
                    {% if item.active or item.current %}
                      <strong class="govuk-service-header__active-fallback">{{- item.html | safe if item.html else item.text -}}</strong>
                    {% else %}
                      {{- item.html | safe if item.html else item.text -}}
                    {% endif %}
                  {% endset %}

                  <li class="govuk-service-header__navigation-item {%- if item.active or item.current %} govuk-service-header__navigation-item--active{% endif %}">
                    {% if item.href %}
                      <a class="govuk-service-header__link" href="{{ item.href }}"
                        {%- if item.active or item.current %} aria-current="{{ 'page' if item.current else 'true' }}"{% endif %}
                        {{- govukAttributes(item.attributes) -}}>
                        {{ linkInnerContent | safe }}
                      </a>
                    {% elif item.html or item.text %}
                      <span class="govuk-service-header__navigation-text"
                        {%- if item.active or item.current %} aria-current="{{ 'page' if item.current else 'true' }}"{% endif %}>
                        {{ linkInnerContent | safe }}
                      </span>
                    {% endif %}
                  </li>
                {% endfor %}

                {# Slot: navigationEnd #}
                {%- if params.slots.navigationEnd %}{{ params.slots.navigationEnd | safe }}{% endif -%}
              </ul>
            </nav>
          {% endif %}
        </div>

        {# Slot: end #}
        {%- if params.slots.end %}{{ params.slots.end | safe }}{% endif -%}

    </div>
  </section>
{% endif %}
